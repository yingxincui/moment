# ETF动量策略分析系统

[![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![Streamlit](https://img.shields.io/badge/Streamlit-1.28+-red.svg)](https://streamlit.io/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)

一个基于动量策略的ETF投资分析系统，支持多种ETF组合配置、Bias分析、趋势图表和邮件订阅功能。

## ✨ 主要功能

### 📈 动量策略分析
- **动量计算**: 基于价格变化的动量指标计算
- **均线过滤**: 使用移动平均线过滤趋势
- **推荐持仓**: 自动选择动量最强且趋势向上的ETF
- **排名展示**: 所有ETF的动量排名和状态

### 🔍 Bias分析
- **多周期偏离度**: 6日、12日、24日偏离度计算
- **超买超卖判断**: 基于动态阈值的智能判断
- **统一表格**: 所有标的在一个表格中展示
- **颜色编码**: 直观的颜色区分不同状态

### 📊 趋势图表
- **累计涨跌幅**: 近一年累计涨跌幅趋势图
- **多标对比**: 所有标的在同一张图上对比
- **性能指标**: 包含收益率、回撤、夏普比率等
- **美化表格**: 专业的表格样式和颜色编码

### 📧 邮件订阅功能
- **自动报告**: 每日/每周自动发送分析报告
- **HTML邮件**: 美观的邮件模板设计
- **多组合支持**: 支持订阅多个ETF组合
- **灵活配置**: 可自定义发送时间和频率

## 🚀 快速开始

### 环境要求
- Python 3.8+
- Windows/macOS/Linux

### 安装步骤

1. **克隆项目**
```bash
git clone https://github.com/yourusername/etf-momentum-strategy.git
cd etf-momentum-strategy
```

2. **安装依赖**
```bash
pip install -r requirements.txt
```

3. **运行应用**
```bash
streamlit run app.py
```

4. **访问系统**
- 打开浏览器访问 `http://localhost:8501`
- 输入暗号验证身份
- 系统将自动跳转到默认组合页面

## 📱 页面结构

### 主要页面
1. **📊 默认组合**: 基础ETF组合分析
2. **🚀 科创创业**: 科创相关ETF分析
3. **🌍 全球股市轮动**: 全球ETF轮动策略
4. **👑 明总定制组合**: 定制ETF组合分析
5. **📧 邮件订阅**: 邮件订阅管理

### 页面功能
- **ETF选择**: 多选ETF进行批量分析
- **参数调整**: 可调整动量周期、均线周期等参数
- **结果展示**: 表格、图表、分析说明等
- **订阅管理**: 邮件订阅设置和管理

## 🔧 技术架构

### 核心模块
- `app.py`: 主应用入口和暗号验证
- `core_strategy.py`: 核心策略逻辑和渲染函数
- `email_subscription.py`: 邮件订阅功能模块
- `email_config.py`: 邮件配置管理
- `etf_pools.py`: ETF池配置

### 数据流程
1. **数据获取**: 通过akshare获取ETF历史数据
2. **策略计算**: 计算动量、均线、偏离度等指标
3. **结果渲染**: 生成表格、图表和分析报告
4. **邮件发送**: 自动生成并发送HTML邮件

### 缓存机制
- **本地缓存**: 避免重复API调用
- **数据验证**: 确保数据完整性和有效性
- **错误处理**: 优雅处理网络和API错误

## 📧 邮件订阅配置

### 配置步骤
1. **开启QQ邮箱SMTP服务**
   - 登录QQ邮箱 → 设置 → 账户
   - 开启"POP3/SMTP服务"
   - 获取授权码

2. **系统配置**
   - 进入"📧 邮件订阅"页面
   - 配置发件人邮箱和授权码
   - 发送测试邮件验证

3. **添加订阅**
   - 选择接收邮箱和ETF组合
   - 设置发送频率（每日/每周）
   - 系统将自动发送报告

### 邮件内容
- 🎯 **今日推荐持仓**: 动量策略推荐的前3名ETF
- 📈 **动量排名概览**: 市场整体趋势统计
- 🔍 **Bias分析汇总**: 超买超卖状态统计
- 📊 **市场表现统计**: 上涨下跌标的统计

## 🎨 界面特性

### 表格样式
- **颜色编码**: 根据数值大小使用不同颜色
- **圆角设计**: 现代化的圆角边框
- **字体优化**: 清晰的字体和间距
- **状态标识**: 直观的状态图标和颜色

### 图表设计
- **响应式布局**: 自适应不同屏幕尺寸
- **交互功能**: 悬停显示详细信息
- **颜色搭配**: 专业的配色方案
- **标签优化**: 清晰的坐标轴和标题

## 🔒 安全特性

### 访问控制
- **密码保护**: 使用暗号验证访问系统
- **会话管理**: 安全的会话状态管理
- **页面重定向**: 自动跳转到默认页面

### 数据安全
- **本地缓存**: 数据存储在本地，保护隐私
- **配置保护**: 邮件配置信息本地存储
- **错误处理**: 避免敏感信息泄露

## 📊 策略说明

本系统采用**动量策略**，通过以下步骤进行投资决策：

1. **动量计算**: 计算各ETF的相对动量排名
2. **趋势过滤**: 使用移动平均线过滤下跌趋势
3. **持仓选择**: 选择动量最强且趋势向上的ETF
4. **动态调整**: 定期重新计算并调整持仓

## 🚨 注意事项

### 使用限制
- **网络要求**: 需要稳定的网络连接获取数据
- **API限制**: 第三方API可能有调用频率限制
- **数据延迟**: 实时数据可能有延迟

### 配置要求
- **QQ邮箱**: 需要开启SMTP服务获取授权码
- **系统运行**: 邮件自动发送需要保持系统运行
- **权限设置**: 确保有文件读写权限

## 🔄 更新日志

### v2.0.0 (2024-01-XX)
- ✨ **新增邮件订阅功能**
  - 支持每日/每周自动发送分析报告
  - 美观的HTML邮件模板
  - 完整的订阅管理系统
  - 支持多个ETF组合订阅

### v1.5.0 (2024-01-XX)
- 🎨 **界面美化升级**
  - 优化表格样式和颜色编码
  - 改进图表设计和交互
  - 统一页面布局和风格

### v1.0.0 (2024-01-XX)
- 🚀 **基础功能发布**
  - 动量策略分析
  - Bias分析功能
  - 趋势图表展示
  - 多页面架构

## 📞 技术支持

### 常见问题
1. **邮件发送失败**: 检查网络连接和邮箱配置
2. **数据获取错误**: 确认网络连接和API状态
3. **界面显示问题**: 检查浏览器兼容性

### 获取帮助
- 查看控制台错误信息
- 检查配置文件设置
- 验证网络连接状态

## 📄 许可证

本项目采用 MIT 许可证 - 查看 [LICENSE](LICENSE) 文件了解详情。

## ⚠️ 免责声明

- 本系统仅供学习和研究使用，不构成投资建议
- 投资有风险，入市需谨慎
- 历史表现不代表未来收益
- 使用者需自行承担投资风险

---

**💡 提示**: 首次使用邮件订阅功能时，建议先发送测试邮件验证配置，确保功能正常工作后再添加正式订阅。

如果这个项目对您有帮助，请给个 ⭐ Star 支持一下！
